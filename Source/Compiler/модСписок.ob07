(* Модуль проводит операции со списками 
   BSD-2*)
МОДУЛЬ модСписок;

ИМПОРТ мТипы := модТипы;

ТИПЫ
      туСписок* = УКАЗАТЕЛЬ НА ЗАПИСЬ
         предыдущ*, следующ*: мТипы.туЗвено;
         счетчик*: ЦЕЛОЕ
      КОНЕЦ;

ПРОЦЕДУРА Создать*(): туСписок;
   ПЕРЕМ
      список_нов: туСписок;
   НАЧАЛО
      НОВ(список_нов)
      ВЕРНУТЬ список_нов
   КОНЕЦ Создать;

ПРОЦЕДУРА Добавить*(сам: туСписок; пункт: мТипы.туЗвено);
   НАЧАЛО
      ЕСЛИ сам.счетчик = 0 ТОГДА
         сам.предыдущ := пункт;
         пункт.предыдущ := ПУСТО
      ИНАЧЕ
         сам.следующ.следующ := пункт;
         пункт.предыдущ := сам.следующ
      КОНЕЦ;
      ДОБ(сам.счетчик);
      сам.следующ := пункт;
      пункт.следующ := ПУСТО
   КОНЕЦ Добавить;

ПРОЦЕДУРА Очистить*(сам: туСписок);
   НАЧАЛО
      сам.предыдущ := ПУСТО;
      сам.следующ := ПУСТО;
      сам.счетчик := 0
   КОНЕЦ Очистить;
 
ПРОЦЕДУРА Вставить*(сам: туСписок; звено_, предыдущ_: мТипы.туЗвено);
   НАЧАЛО
      ЕСЛИ предыдущ_ # сам.следующ ТОГДА
         звено_.следующ := предыдущ_.следующ;
         звено_.предыдущ := предыдущ_;
         предыдущ_.следующ := звено_;
         звено_.следующ.предыдущ := звено_;
         ДОБ(сам.счетчик)
      ИНАЧЕ
         Добавить(сам, звено_)
      КОНЕЦ
   КОНЕЦ Вставить;

КОНЕЦ модСписок.
